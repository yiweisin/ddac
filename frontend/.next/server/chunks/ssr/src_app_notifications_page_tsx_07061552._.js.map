{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/yiweisin/GitHub/ddac/frontend/src/app/notifications/page.tsx"],"sourcesContent":["// frontend/src/app/notifications/page.tsx\n\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuth } from \"../../context/AuthContext\";\nimport {\n  getNotificationPreferences,\n  updateNotificationPreferences,\n  sendTestNotification,\n} from \"@/lib/api\";\nimport { NotificationPreferences } from \"@/types/notification\";\n\nexport default function NotificationsPage() {\n  const { user, loading } = useAuth();\n  const router = useRouter();\n\n  const [preferences, setPreferences] = useState<NotificationPreferences>({\n    email: \"\",\n    phoneNumber: \"\",\n    emailNotificationsEnabled: false,\n    smsNotificationsEnabled: false,\n  });\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isTesting, setIsTesting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!loading && !user) {\n      router.push(\"/login\");\n    } else if (user) {\n      fetchPreferences();\n    }\n  }, [user, loading, router]);\n\n  const fetchPreferences = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const data = await getNotificationPreferences();\n      setPreferences(data);\n    } catch (err) {\n      setError(\"Failed to load notification preferences\");\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value, type, checked } = e.target;\n    setPreferences((prev) => ({\n      ...prev,\n      [name]: type === \"checkbox\" ? checked : value,\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSaving(true);\n    setError(null);\n    setSuccess(null);\n\n    try {\n      await updateNotificationPreferences(preferences);\n      setSuccess(\"Notification preferences updated successfully\");\n    } catch (err) {\n      setError(\"Failed to update notification preferences\");\n      console.error(err);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleTestNotification = async () => {\n    setIsTesting(true);\n    setError(null);\n    setSuccess(null);\n\n    try {\n      await sendTestNotification();\n      setSuccess(\"Test notification sent successfully\");\n    } catch (err) {\n      setError(\"Failed to send test notification\");\n      console.error(err);\n    } finally {\n      setIsTesting(false);\n    }\n  };\n\n  if (loading || isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-96 bg-slate-50\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-slate-700 font-medium\">\n            Loading notification settings...\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto my-8 px-6\">\n      <div className=\"bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden\">\n        <div className=\"bg-gradient-to-r from-slate-800 to-slate-700 px-8 py-6 text-white\">\n          <h1 className=\"text-2xl font-bold\">Notification Settings</h1>\n          <p className=\"text-slate-300 mt-1\">\n            Manage how you receive notifications\n          </p>\n        </div>\n\n        <div className=\"p-8\">\n          {error && (\n            <div className=\"mb-6 bg-rose-50 border-l-4 border-rose-500 text-rose-700 p-4 rounded-md\">\n              {error}\n            </div>\n          )}\n\n          {success && (\n            <div className=\"mb-6 bg-emerald-50 border-l-4 border-emerald-500 text-emerald-700 p-4 rounded-md\">\n              {success}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"bg-slate-50 rounded-lg p-6 border border-slate-200\">\n              <h2 className=\"text-lg font-semibold text-slate-800 mb-4\">\n                Email Notifications\n              </h2>\n\n              <div className=\"flex items-center mb-4\">\n                <input\n                  id=\"emailNotificationsEnabled\"\n                  name=\"emailNotificationsEnabled\"\n                  type=\"checkbox\"\n                  checked={preferences.emailNotificationsEnabled}\n                  onChange={handleChange}\n                  className=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"\n                />\n                <label\n                  htmlFor=\"emailNotificationsEnabled\"\n                  className=\"ml-2 block text-sm text-gray-700\"\n                >\n                  Enable email notifications\n                </label>\n              </div>\n\n              <div className=\"mt-2\">\n                <label\n                  htmlFor=\"email\"\n                  className=\"block text-sm font-medium text-gray-700\"\n                >\n                  Email address\n                </label>\n                <input\n                  type=\"email\"\n                  id=\"email\"\n                  name=\"email\"\n                  value={preferences.email || \"\"}\n                  onChange={handleChange}\n                  className=\"mt-1 block w-full p-2.5 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                  placeholder=\"your.email@example.com\"\n                  disabled={!preferences.emailNotificationsEnabled}\n                />\n              </div>\n            </div>\n\n            <div className=\"bg-slate-50 rounded-lg p-6 border border-slate-200\">\n              <h2 className=\"text-lg font-semibold text-slate-800 mb-4\">\n                SMS Notifications\n              </h2>\n\n              <div className=\"flex items-center mb-4\">\n                <input\n                  id=\"smsNotificationsEnabled\"\n                  name=\"smsNotificationsEnabled\"\n                  type=\"checkbox\"\n                  checked={preferences.smsNotificationsEnabled}\n                  onChange={handleChange}\n                  className=\"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded\"\n                />\n                <label\n                  htmlFor=\"smsNotificationsEnabled\"\n                  className=\"ml-2 block text-sm text-gray-700\"\n                >\n                  Enable SMS notifications\n                </label>\n              </div>\n\n              <div className=\"mt-2\">\n                <label\n                  htmlFor=\"phoneNumber\"\n                  className=\"block text-sm font-medium text-gray-700\"\n                >\n                  Phone number\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"phoneNumber\"\n                  name=\"phoneNumber\"\n                  value={preferences.phoneNumber || \"\"}\n                  onChange={handleChange}\n                  className=\"mt-1 block w-full p-2.5 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                  placeholder=\"+1234567890\"\n                  disabled={!preferences.smsNotificationsEnabled}\n                />\n                <p className=\"mt-1 text-sm text-gray-500\">\n                  Enter your phone number with country code (e.g., +1 for US\n                  numbers)\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-between\">\n              <button\n                type=\"submit\"\n                disabled={isSaving}\n                className=\"px-5 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium shadow-sm transition-all flex items-center disabled:opacity-50\"\n              >\n                {isSaving ? (\n                  <>\n                    <svg\n                      className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      fill=\"none\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <circle\n                        className=\"opacity-25\"\n                        cx=\"12\"\n                        cy=\"12\"\n                        r=\"10\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"4\"\n                      ></circle>\n                      <path\n                        className=\"opacity-75\"\n                        fill=\"currentColor\"\n                        d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                      ></path>\n                    </svg>\n                    Saving...\n                  </>\n                ) : (\n                  \"Save Settings\"\n                )}\n              </button>\n\n              <button\n                type=\"button\"\n                onClick={handleTestNotification}\n                disabled={\n                  isTesting ||\n                  (!preferences.emailNotificationsEnabled &&\n                    !preferences.smsNotificationsEnabled)\n                }\n                className=\"px-5 py-2.5 bg-slate-600 hover:bg-slate-700 text-white rounded-lg font-medium shadow-sm transition-all flex items-center disabled:opacity-50\"\n              >\n                {isTesting ? (\n                  <>\n                    <svg\n                      className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      fill=\"none\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <circle\n                        className=\"opacity-25\"\n                        cx=\"12\"\n                        cy=\"12\"\n                        r=\"10\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"4\"\n                      ></circle>\n                      <path\n                        className=\"opacity-75\"\n                        fill=\"currentColor\"\n                        d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                      ></path>\n                    </svg>\n                    Sending...\n                  </>\n                ) : (\n                  \"Send Test Notification\"\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}